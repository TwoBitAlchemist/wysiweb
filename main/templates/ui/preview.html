{% extends 'elements/document.html' %}
{% load staticfiles %}
{% block preview_extra_headers %}
<script src="{% static 'admin/js/snap_selection.js' %}"></script>
<script>
$(document).ready(function(){
    $('.container *').on('click', function(){
        $(this).prop('contenteditable', true).focus();
    }).on('blur', function(){
        var blurred = $(this);
        var elemid = blurred.data('object');
        $('#' + elemid + '-text')
            .addClass('updated')
            .val(blurred.text().trim());
    }).on('mouseup', snapSelectionToWord);
});
</script>
{% endblock %}
{% block preview_hidden %}
{% load mptt_tags %}
{% load wysiweb_filters %}
{% recursetree elements.all %}
<input type="hidden" value="{{ node.text }}"
    id="{{ node|elemid }}-text">
{% if not node.is_leaf_node %}
{{ children }}
{% endif %}
{% endrecursetree %}
{% endblock %}
